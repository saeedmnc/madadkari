module.exports = function (grunt) {

	grunt.initConfig({
		uglify: {
			build: {
				src: 'src/app.js',
				dest: 'tmp/app.js'
			}
		},
		less: {
			build: {
				options: {
					compress: true
				},
				src: 'src/app.less',
				dest: 'tmp/app.css'
			}
		}
	})

	grunt.loadNpmTasks('grunt-contrib-uglify')
	grunt.loadNpmTasks('grunt-contrib-less')

	grunt.registerTask('toResource', 'concat app.js, app.css to lib/resource.js', function () {
		var js = grunt.file.read('tmp/app.js')
		var css = grunt.file.read('tmp/app.css')
		grunt.file.write('lib/resource.js', (
			'/* src/app.js */\n' +
			"exports.js = " + JSON.stringify(js) + "\n" +
			'/* src/app.less */\n' +
			"exports.css = " + JSON.stringify(css)
		))
	})

	grunt.registerTask('default', ['uglify:build', 'less:build', 'toResource'])

}